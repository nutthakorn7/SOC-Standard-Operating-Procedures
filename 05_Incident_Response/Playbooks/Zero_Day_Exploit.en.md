# Playbook: Zero-Day Exploit Response

**ID**: PB-24
**Severity**: Critical | **Category**: Vulnerability Exploitation
**MITRE ATT&CK**: [T1190](https://attack.mitre.org/techniques/T1190/) (Exploit Public-Facing Application), [T1203](https://attack.mitre.org/techniques/T1203/) (Exploitation for Client Execution)
**Trigger**: Vendor advisory (0-day), TI alert, CISA KEV, Anomalous behavior without known CVE

### Zero-Day Response Timeline

```mermaid
graph LR
    Disc["ðŸ” 0-day Discovered"] --> Assess["âš–ï¸ Impact?"]
    Assess --> Mitigate["ðŸ›¡ï¸ Virtual Patch"]
    Mitigate --> Monitor["ðŸ‘ï¸ Monitor"]
    Monitor --> Patch["ðŸ©¹ Vendor Patch"]
    Patch --> Apply["âœ… Deploy"]
    style Disc fill:#e74c3c,color:#fff
    style Mitigate fill:#f39c12,color:#fff
    style Apply fill:#27ae60,color:#fff
```

### Vulnerability Triage

```mermaid
sequenceDiagram
    participant TI as Threat Intel
    participant SOC
    participant VM as Vuln Mgmt
    participant Ops
    TI->>SOC: ðŸš¨ 0-day advisory
    SOC->>VM: Scan for vulnerable assets
    VM-->>SOC: Found 50 servers
    SOC->>Ops: WAF virtual patch immediately
    Ops-->>SOC: âœ… Virtual patch active
    Note over SOC: â³ Wait for vendor patch
```

> ðŸš¨ **ZERO-DAY = No Patch Available**. Immediate compensating controls and virtual patching are critical until vendor releases a fix.

---

## Decision Flow

```mermaid
graph TD
    Alert["ðŸš¨ Zero-Day Alert"] --> Source{"ðŸ“¢ Source?"}
    Source -->|Vendor Advisory| Vendor["ðŸ“„ Review CVE + Advisory"]
    Source -->|CISA KEV| KEV["ðŸ›ï¸ In Active Exploitation"]
    Source -->|Threat Intel / News| TI["ðŸ“° Emerging Zero-Day"]
    Source -->|Internal Anomaly| Internal["ðŸ” Unknown Exploit Detected"]
    Vendor --> Exposure["ðŸ“Š Asset Inventory â€” Are We Affected?"]
    KEV --> Exposure
    TI --> Exposure
    Internal --> Exposure
    Exposure -->|Yes, We Run Affected Software| Affected["ðŸ”´ Assess Exploitation"]
    Exposure -->|No| Safe["âœ… Monitor â€” Not Affected"]
    Affected --> IOC{"ðŸ” IoCs Found?"}
    IOC -->|Yes â€” Actively Exploited| Compromised["ðŸ”´ Confirmed Compromise"]
    IOC -->|No IoCs Yet| Mitigate["ðŸŸ  Apply Emergency Mitigations"]
    Compromised --> FullIR["ðŸ”’ Full IR + Emergency Containment"]
    Mitigate --> VPatch["ðŸ›¡ï¸ Virtual Patch + Monitor"]
```

---

## 1. Analysis

### 1.1 Zero-Day Assessment Framework

| Factor | Assessment | Score |
|:---|:---|:---|
| **CVSS Score** | ___/10 | |
| **Attack Vector** | Network / Adjacent / Local / Physical | |
| **Complexity** | Low / High | |
| **Authentication Required** | None / Low / High | |
| **CISA KEV Listed** | Yes / No | |
| **Active Exploitation Confirmed** | Yes / No | |
| **Public PoC Available** | Yes / No | |
| **Patch Available** | Yes / No (Zero-Day = No) | |
| **Our Exposure** | Internet-facing / Internal / Not affected | |

### 1.2 Investigation Checklist

| Check | How | Done |
|:---|:---|:---:|
| What software/version is affected? | Advisory / CVE | â˜ |
| Inventory ALL systems running affected software | CMDB, vulnerability scanner | â˜ |
| Are any affected systems internet-facing? | Firewall rules, Shodan, ASM | â˜ |
| Search for advisory-provided IoCs | EDR, SIEM, network logs | â˜ |
| Check for web shells, new files, backdoors | EDR, file integrity monitor | â˜ |
| Check for unusual outbound connections | Proxy / firewall / netflow | â˜ |
| Review logs for exploitation attempts | WAF / IDS / application logs | â˜ |
| Are vendor workarounds available? | Advisory | â˜ |

### 1.3 Exposure Priority Matrix

| System Type | Internet-Facing | Severity | Action |
|:---|:---|:---|:---|
| **Production, Internet-facing** | Yes | ðŸ”´ Critical | Immediate mitigation |
| **Production, Internal** | No | ðŸŸ  High | Priority mitigation |
| **Dev/Test, Internet-facing** | Yes | ðŸŸ  High | Take offline or mitigate |
| **Dev/Test, Internal** | No | ðŸŸ¡ Medium | Schedule mitigation |

---

## 2. Containment

### 2.1 Emergency Mitigations (No Patch Available)

| # | Action | Done |
|:---:|:---|:---:|
| 1 | **Disable vulnerable feature/service** if possible | â˜ |
| 2 | **Restrict network access** to affected systems (ACLs/FW rules) | â˜ |
| 3 | **Virtual patching** â€” deploy IPS/WAF signatures for exploit attempt | â˜ |
| 4 | **Take offline** internet-facing instances if business allows | â˜ |
| 5 | **Increase logging** on affected systems | â˜ |

### 2.2 If Exploitation Confirmed

| # | Action | Done |
|:---:|:---|:---:|
| 1 | **Isolate** compromised systems from network | â˜ |
| 2 | **Snapshot/image** compromised systems for forensics | â˜ |
| 3 | **Block** C2 IPs/domains from advisory | â˜ |
| 4 | **Disable** compromised user accounts | â˜ |

---

## 3. Eradication

| # | Action | Done |
|:---:|:---|:---:|
| 1 | **Apply vendor patch** as soon as released (emergency change) | â˜ |
| 2 | **Perform forensics** â€” determine attack scope, lateral movement, data access | â˜ |
| 3 | **Reset credentials** for accounts on compromised systems | â˜ |
| 4 | **Hunt for backdoors** â€” web shells, implants, scheduled tasks, new users | â˜ |
| 5 | **Remove** all attacker artifacts | â˜ |
| 6 | **Verify integrity** â€” compare critical files to known-good baseline | â˜ |

---

## 4. Recovery

### 4.1 Patching Priority

| Priority | System Type | Timeline |
|:---|:---|:---|
| **P0** | Internet-facing, exploited | Immediately |
| **P1** | Internet-facing, not yet exploited | Within 24 hours |
| **P2** | Internal, critical | Within 48 hours |
| **P3** | Internal, non-critical | Within 7 days |

### 4.2 Post-Patch Actions

| # | Action | Done |
|:---:|:---|:---:|
| 1 | Validate patch applied successfully | â˜ |
| 2 | Verify vulnerability no longer exploitable | â˜ |
| 3 | Check for residual compromise EVEN after patching | â˜ |
| 4 | Update SBOM with patched versions | â˜ |
| 5 | Monitor for re-exploitation attempts for 30 days | â˜ |

---

## 5. Communication

| Audience | When | What |
|:---|:---|:---|
| **CISO** | Immediately for Critical CVSS | Exposure assessment, mitigation status |
| **Executive team** | If confirmed exploitation | Business impact, remediation timeline |
| **Legal / DPO** | If data breach confirmed | PDPA notification (72h) |
| **Vendor** | If you discover a new zero-day | Coordinated Vulnerability Disclosure (CVD) |
| **ISACs / Peers** | After confirming IoCs | TLP:AMBER or TLP:GREEN sharing |
| **Regulators** | If critical infrastructure affected | Per regulatory requirements |

---

## 6. IoC Collection

| Type | Value | Source |
|:---|:---|:---|
| CVE ID | | Advisory |
| Affected software/version | | Advisory |
| Exploit payload/signature | | Advisory / IDS |
| C2 domains/IPs | | Advisory / TI |
| Web shell / backdoor hashes | | EDR / Forensics |
| Attacker IP | | WAF / IDS / Logs |

---

## 7. Escalation Criteria

| Condition | Escalate To |
|:---|:---|
| Internet-facing system with active exploitation | CISO + Major Incident |
| Public PoC available + we're exposed | SOC Lead urgently |
| Data exfiltration during exploitation | Legal + DPO (PDPA 72h) |
| Multiple systems compromised | Major Incident team |
| Nation-state indicators | Law enforcement + National CERT |
| You discover a new zero-day in our systems | CISO + CVD process |

---

### Threat Intel Coordination

```mermaid
sequenceDiagram
    participant CERT
    participant TI as Threat Intel
    participant SOC
    participant Ops
    CERT->>TI: ðŸš¨ Zero-day advisory
    TI->>SOC: Assess impact
    SOC->>Ops: Scan for vulnerable assets
    Ops-->>SOC: Found 50 servers
    SOC->>Ops: Deploy virtual patch
    Ops-->>SOC: âœ… Patched
```

### Compensating Controls

```mermaid
graph TD
    ZeroDay["ðŸ”“ Zero-Day"] --> WAF["ðŸ›¡ï¸ WAF virtual patch"]
    ZeroDay --> Segment["ðŸ”’ Network segmentation"]
    ZeroDay --> ACL["ðŸ“‹ Restrict access"]
    ZeroDay --> Monitor["ðŸ‘ï¸ Enhanced monitoring"]
    WAF --> Wait["â³ Wait vendor patch"]
    Segment --> Wait
    ACL --> Wait
    Monitor --> Wait
    Wait --> Apply["âœ… Apply official patch"]
    style ZeroDay fill:#e74c3c,color:#fff
    style Apply fill:#27ae60,color:#fff
```

## Related Documents

- [IR Framework](../Framework.en.md)
- [Incident Report](../../templates/incident_report.en.md)
- [PB-18 Exploit](Exploit.en.md)
- [PB-32 Supply Chain](Supply_Chain_Attack.en.md)
- [PB-09 Lateral Movement](Lateral_Movement.en.md)

## References

- [MITRE ATT&CK T1190 â€” Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190/)
- [CISA Known Exploited Vulnerabilities (KEV)](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)
- [NIST NVD â€” National Vulnerability Database](https://nvd.nist.gov/)
- [FIRST â€” Coordinated Vulnerability Disclosure](https://www.first.org/global/sigs/vulnerability-coordination/)
